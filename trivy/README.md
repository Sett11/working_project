# üõ°Ô∏è Trivy Security Scanner - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û –ø—Ä–æ–µ–∫—Ç–µ](#–æ-–ø—Ä–æ–µ–∫—Ç–µ)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ñ–∞–π–ª–æ–≤)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤](#–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
- [Troubleshooting](#troubleshooting)
- [Best Practices](#best-practices)

---

## üîç –û –ø—Ä–æ–µ–∫—Ç–µ

**Trivy** ‚Äî —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π open-source —Å–∫–∞–Ω–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ—Ç Aqua Security, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å:

- üêõ **–£—è–∑–≤–∏–º–æ—Å—Ç–∏** –≤ Docker –æ–±—Ä–∞–∑–∞—Ö, –ø–∞–∫–µ—Ç–∞—Ö –û–° –∏ —è–∑—ã–∫–æ–≤—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö
- ‚öôÔ∏è **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** (IaC, Docker, Kubernetes)
- üîê **–£—Ç–µ—á–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤** (–ø–∞—Ä–æ–ª–∏, API –∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã)
- üìú **–õ–∏—Ü–µ–Ω–∑–∏–∏** –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –ø–∞–∫–µ—Ç–æ–≤

### –ü–æ—á–µ–º—É Trivy?

- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –∏ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∞–≥–µ–Ω—Ç–æ–≤
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º–∞—è –±–∞–∑–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –æ—Ç—á—ë—Ç–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- ‚úÖ **Docker Desktop** —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω
- ‚úÖ **PowerShell** (–≤—Å—Ç—Ä–æ–µ–Ω –≤ Windows)
- ‚úÖ **Docker –æ–±—Ä–∞–∑—ã** —Å–æ–±—Ä–∞–Ω—ã (Backend, Frontend, DB)

### –ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞ 30 —Å–µ–∫—É–Ω–¥

```powershell
# 1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é trivy
cd trivy

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞–∑–æ–≤
.\scan-all.ps1
```

**–í–æ—Ç –∏ –≤—Å—ë!** üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `trivy/reports/`

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Docker (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

Trivy —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ Docker! –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç –æ–±—Ä–∞–∑ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

```powershell
# –û–±—Ä–∞–∑ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
.\scan-all.ps1
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Trivy (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Trivy –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ Docker:

#### Windows

1. –°–∫–∞—á–∞–π—Ç–µ [Trivy –¥–ª—è Windows](https://github.com/aquasecurity/trivy/releases/latest)
2. –†–∞—Å–ø–∞–∫—É–π—Ç–µ `trivy.exe` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—É—é –≤ PATH
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É:

```powershell
trivy --version
```

#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ —á–µ—Ä–µ–∑ Scoop

```powershell
scoop install trivy
```

---

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

#### 1Ô∏è‚É£ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞–∑–æ–≤

```powershell
cd trivy
.\scan-all.ps1
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –°–∫–∞–Ω–∏—Ä—É–µ—Ç Backend –æ–±—Ä–∞–∑
- ‚úÖ –°–∫–∞–Ω–∏—Ä—É–µ—Ç Frontend –æ–±—Ä–∞–∑ (–µ—Å–ª–∏ —Å–æ–±—Ä–∞–Ω)
- ‚úÖ –°–∫–∞–Ω–∏—Ä—É–µ—Ç Database –æ–±—Ä–∞–∑ (postgres:15-alpine)
- üìä –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç

#### 2Ô∏è‚É£ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ Backend

```powershell
cd trivy
.\scan-backend.ps1
```

#### 3Ô∏è‚É£ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ Frontend

```powershell
cd trivy
.\scan-frontend.ps1
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Frontend –æ–±—Ä–∞–∑ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥ —Ñ–∏–Ω–∞–ª—å–Ω—ã–º –¥–µ–ø–ª–æ–µ–º:

```powershell
# –°–Ω–∞—á–∞–ª–∞ —Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑
cd ..
docker-compose build frontend

# –ó–∞—Ç–µ–º –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ
cd trivy
.\scan-frontend.ps1
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Docker Compose

```powershell
# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–∞
docker-compose -f trivy/docker-compose.trivy.yml run --rm trivy-scan image your_image_name:tag

# –ü—Ä–∏–º–µ—Ä: —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ backend
docker-compose -f trivy/docker-compose.trivy.yml run --rm trivy-scan image working_project_backend
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
trivy/
‚îú‚îÄ‚îÄ üìÑ README.md                    # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ üê≥ docker-compose.trivy.yml     # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ ‚öôÔ∏è trivy-config.yaml            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Trivy
‚îÇ
‚îú‚îÄ‚îÄ üìú –°–∫—Ä–∏–ø—Ç—ã PowerShell:
‚îÇ   ‚îú‚îÄ‚îÄ scan-all.ps1                # –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–±—Ä–∞–∑–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ scan-backend.ps1            # –¢–æ–ª—å–∫–æ Backend
‚îÇ   ‚îî‚îÄ‚îÄ scan-frontend.ps1           # –¢–æ–ª—å–∫–æ Frontend
‚îÇ
‚îú‚îÄ‚îÄ üìä reports/                     # –û—Ç—á—ë—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ scan_backend_*.json
‚îÇ   ‚îú‚îÄ‚îÄ scan_backend_*.txt
‚îÇ   ‚îú‚îÄ‚îÄ scan_frontend_*.json
‚îÇ   ‚îú‚îÄ‚îÄ scan_frontend_*.txt
‚îÇ   ‚îî‚îÄ‚îÄ summary_*.txt               # –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç
‚îÇ
‚îî‚îÄ‚îÄ üìù logs/                        # –õ–æ–≥–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª `trivy-config.yaml`

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:

```yaml
scan:
  scanners:
    - vuln        # –£—è–∑–≤–∏–º–æ—Å—Ç–∏
    - misconfig   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    - secret      # –°–µ–∫—Ä–µ—Ç—ã
  
  severity:
    - CRITICAL    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ
    - HIGH        # –í—ã—Å–æ–∫–∏–µ
    - MEDIUM      # –°—Ä–µ–¥–Ω–∏–µ

exit:
  code: 1                    # –ü—Ä–µ—Ä—ã–≤–∞—Ç—å –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
  on-severity:
    - CRITICAL               # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
    - HIGH                   # –í—ã—Å–æ–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è TRIVY_CACHE_DIR

–í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∫—ç—à–∞ Trivy —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:

**Windows PowerShell:**
```powershell
$env:TRIVY_CACHE_DIR = "C:\Temp\trivy-cache"
.\scan-all.ps1
```

**Linux/macOS:**
```bash
export TRIVY_CACHE_DIR=/tmp/trivy-cache
./scan-all.sh
```

**Docker Compose:**
```yaml
environment:
  - TRIVY_CACHE_DIR=/custom/cache/path
```

**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `./.trivy-cache` –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –°–∫—Ä–∏–ø—Ç—ã —Å–æ–∑–¥–∞—é—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `trivy/cache` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –≠—Ç–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –≤ non-root –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö –∏ CI/CD –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö

### –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.trivyignore` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é CVE
CVE-2023-12345

# –° –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º
CVE-2023-67890 # –ü—Ä–∏–Ω—è—Ç —Ä–∏—Å–∫ –ø–æ—Å–ª–µ security review

# –° –¥–∞—Ç–æ–π –∏—Å—Ç–µ—á–µ–Ω–∏—è
CVE-2024-11111 exp:2025-12-31 # –ñ–¥—ë–º –ø–∞—Ç—á
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –§–∞–π–ª `.trivyignore` –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Ä—è–¥–æ–º —Å docker-compose.yml). –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Ä–æ–≤–Ω–µ–π –≤–∞–∂–Ω–æ—Å—Ç–∏

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `scan-all.ps1`:

```powershell
# –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
--severity CRITICAL,HIGH,MEDIUM

# –ù–∞ –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥—É—é:
--severity CRITICAL
```

---

## üìä –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –£—Ä–æ–≤–Ω–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏

| –£—Ä–æ–≤–µ–Ω—å | –ó–Ω–∞—á–µ–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|---------|----------|----------|
| üî¥ **CRITICAL** | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ | ‚ùó –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
| üü† **HIGH** | –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ | ‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è (1-7 –¥–Ω–µ–π) |
| üü° **MEDIUM** | –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫ | üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (1-4 –Ω–µ–¥–µ–ª–∏) |
| üîµ **LOW** | –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫ | üìù –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ |

### –ü—Ä–∏–º–µ—Ä –æ—Ç—á—ë—Ç–∞

```
Backend (working_project_backend)
--------------------------------------------------------------------------------
–°—Ç–∞—Ç—É—Å: Completed
–£—è–∑–≤–∏–º–æ—Å—Ç–∏:
  üî¥ CRITICAL: 2
  üü† HIGH:     5
  üü° MEDIUM:   12
  üîµ LOW:      20
```

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç: `reports/scan_backend_*.txt`
2. –ù–∞–π–¥–∏—Ç–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ CRITICAL –∏ HIGH
3. –û–±–Ω–æ–≤–∏—Ç–µ —É—è–∑–≤–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã –≤ `requirements.txt` –∏–ª–∏ `package.json`
4. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑: `docker-compose build backend`
5. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### –£—è–∑–≤–∏–º–æ—Å—Ç—å –≤ –±–∞–∑–æ–≤–æ–º –æ–±—Ä–∞–∑–µ (Python, Node, Alpine)

```dockerfile
# ‚ùå –ü–ª–æ—Ö–æ
FROM python:3.9-slim

# ‚úÖ –•–æ—Ä–æ—à–æ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é
FROM python:3.9.18-slim
```

#### –£—è–∑–≤–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python

```bash
# –û–±–Ω–æ–≤–∏—Ç–µ requirements.txt
pip list --outdated
pip install --upgrade package-name==new-version
```

#### –£—è–∑–≤–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Node.js

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
npm outdated

# –û–±–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç—ã
npm update package-name
```

---

## üîß Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied" –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫—ç—à–µ–º

```powershell
Error: failed to save cache: permission denied
```

**–†–µ—à–µ–Ω–∏–µ:**
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è TRIVY_CACHE_DIR –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø—Ä–∞–≤–∞–º–∏ –∑–∞–ø–∏—Å–∏:

```powershell
# Windows
$env:TRIVY_CACHE_DIR = "$env:TEMP\trivy-cache"

# Linux/macOS
export TRIVY_CACHE_DIR=/tmp/trivy-cache
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):
```powershell
cd trivy
.\scan-all.ps1
# –ö—ç—à –±—É–¥–µ—Ç –≤ trivy/cache/
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Docker –Ω–µ –Ω–∞–π–¥–µ–Ω"

```powershell
‚úó Docker –Ω–µ –Ω–∞–π–¥–µ–Ω! –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker Desktop.
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Docker Desktop](https://www.docker.com/products/docker-desktop/)
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker Desktop
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `docker --version`

### –ü—Ä–æ–±–ª–µ–º–∞: "–û–±—Ä–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω"

```powershell
‚ö† –û–±—Ä–∞–∑ 'working_project_backend' –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º...
```

**–†–µ—à–µ–Ω–∏–µ:**

```powershell
# –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑
docker-compose build backend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ
docker images | grep working_project
```

### –ü—Ä–æ–±–ª–µ–º–∞: Frontend –Ω–µ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è

**–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!** Frontend –æ–±—Ä–∞–∑ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º.

**–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å Frontend:**

```powershell
# 1. –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑
docker-compose build frontend

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
cd trivy
.\scan-frontend.ps1
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü—Ä–∏—á–∏–Ω–∞:** –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ ~1-2 –º–∏–Ω—É—Ç—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥—É—Ç –±—ã—Å—Ç—Ä–µ–µ (–±–∞–∑–∞ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è)

### –ü—Ä–æ–±–ª–µ–º–∞: –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

**–ù–æ—Ä–º–∞–ª—å–Ω–æ!** –î–∞–∂–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–∑—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏.

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –§–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ CRITICAL –∏ HIGH
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.trivyignore` –¥–ª—è –ø—Ä–∏–Ω—è—Ç—ã—Ö —Ä–∏—Å–∫–æ–≤
3. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –æ–±—Ä–∞–∑—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

---

## üéØ Best Practices

### 1. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```powershell
# –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:
# ‚úÖ –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
# ‚úÖ –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è Dockerfile
# ‚úÖ –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –≤ production
# ‚úÖ –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –∫–∞–∫ —á–∞—Å—Ç—å security audit
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

```dockerfile
# ‚ùå –ü–ª–æ—Ö–æ - floating tags
FROM nginx:alpine
FROM python:3.9

# ‚úÖ –•–æ—Ä–æ—à–æ - —Ç–æ—á–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
FROM nginx:1.29.1-alpine
FROM python:3.9.18-slim
```

### 3. –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –±–∞–∑–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã

```dockerfile
# ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ slim/alpine –≤–µ—Ä—Å–∏–∏
FROM python:3.9-slim
FROM node:20-alpine
```

### 4. Multi-stage builds

```dockerfile
# ‚úÖ –û—Å—Ç–∞–≤–ª—è–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –æ–±—Ä–∞–∑–µ
FROM node:20-alpine AS builder
# ... build steps ...

FROM nginx:1.29.1-alpine
COPY --from=builder /app/dist /usr/share/nginx/html
```

### 5. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

#### –î–æ–±–∞–≤—å—Ç–µ –≤ Git hooks

–°–æ–∑–¥–∞–π—Ç–µ `.git/hooks/pre-commit`:

```bash
#!/bin/bash
cd trivy
powershell -ExecutionPolicy Bypass -File scan-all.ps1
```

#### –ó–∞–ø—É—Å–∫ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (Windows Task Scheduler)

```powershell
# –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–¥–∞—á—É, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—É—Å–∫–∞–µ—Ç scan-all.ps1 –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é
```

### 6. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

```bash
# .trivyignore
CVE-2023-12345 # Backend: False positive - –∫–æ–¥ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
CVE-2024-67890 exp:2025-12-31 # Frontend: –ü–∞—Ç—á –≤—ã–π–¥–µ—Ç –≤ –¥–µ–∫–∞–±—Ä–µ
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- üìñ [Trivy Documentation](https://aquasecurity.github.io/trivy/)
- üêô [GitHub Repository](https://github.com/aquasecurity/trivy)
- üí¨ [Community Discussions](https://github.com/aquasecurity/trivy/discussions)

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [CVE Details](https://www.cvedetails.com/) - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ CVE
- [NVD Database](https://nvd.nist.gov/) - National Vulnerability Database
- [Docker Security](https://docs.docker.com/engine/security/) - Docker Security Best Practices

### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏:
- Trivy: `docker pull aquasec/trivy:0.63.0` (—Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: 0.63.0, –≤—ã–ø—É—â–µ–Ω–∞ 30.05.2025)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–µ —Ä–µ–ª–∏–∑—ã: https://github.com/aquasecurity/trivy/releases
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –í–æ–ø—Ä–æ—Å—ã –∏ –ø—Ä–æ–±–ª–µ–º—ã

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [Troubleshooting](#troubleshooting)
2. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ `trivy/logs/`
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

–ï—Å–ª–∏ –Ω–∞—à–ª–∏ –ø—Ä–æ–±–ª–µ–º—É –∏–ª–∏ –µ—Å—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:
- –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
- –°–≤—è–∂–∏—Ç–µ—Å—å —Å security team

---

## üìù Changelog

### 2025-10-08 (–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ 3) - Production-Safe Configuration
- ‚úÖ **CRITICAL FIX:** –ò–∑–º–µ–Ω—ë–Ω exit code —Å 0 –Ω–∞ 1 –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `on-severity` –¥–ª—è CRITICAL –∏ HIGH —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- ‚úÖ **CACHE FIX:** –ó–∞–º–µ–Ω—ë–Ω —Ö–∞—Ä–¥–∫–æ–¥ –ø—É—Ç–∏ –∫—ç—à–∞ `/root/.cache/trivy` –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `TRIVY_CACHE_DIR` —Å fallback –Ω–∞ `./.trivy-cache`
- ‚úÖ **IGNOREFILE FIX:** –ò–∑–º–µ–Ω—ë–Ω –ø—É—Ç—å —Å –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ `/.trivyignore` –Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π `.trivyignore`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ PowerShell —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—ç—à-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π
- ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω docker-compose.trivy.yml —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—É—Ç—è–º–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ TRIVY_CACHE_DIR
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å non-root –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –∏ CI/CD –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

### 2025-10-08 (–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ 2)
- ‚úÖ –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ Trivy —Å `latest` –Ω–∞ `0.63.0` –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Å–±–æ—Ä–æ–∫
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ PowerShell –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

### 2025-10-08 (–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ 1)
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Trivy —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ nginx –¥–æ 1.29.1-alpine (CVE-2025-23419)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ PowerShell —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Backend, Frontend, Database

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

Trivy is licensed under Apache License 2.0  
¬© 2023 Aqua Security Software Ltd.

---

**üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - —ç—Ç–æ –ø—É—Ç—å, –∞ –Ω–µ –º–µ—Å—Ç–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è. –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ!**

